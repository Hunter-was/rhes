<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>To-Do List with GPS</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    label, input, select, button { margin-top: 10px; display: block; }
    .task { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
  </style>
</head>
<body>

  <h1>To-Do List with GPS</h1>

  <label for="task">Task name:</label>
  <input type="text" id="task" placeholder="Enter task name">

  <label for="due">Due date:</label>
  <input type="date" id="due">

  <label for="color">Color:</label>
  <input type="color" id="color">

  <button onclick="addTask()">Add Task</button>
  <button onclick="getLocation()">Get My Location</button>

  <h2>Your Tasks</h2>
  <div id="taskList"></div>

  <h2>Your Coordinates</h2>
  <div id="location"></div>

  <script>
    let tasks = JSON.parse(localStorage.getItem("tasks") || "[]");

    function saveTasks() {
      localStorage.setItem("tasks", JSON.stringify(tasks));
    }

    function addTask() {
      const name = document.getElementById("task").value.trim();
      const due = document.getElementById("due").value;
      const color = document.getElementById("color").value;

      if (!name || !due) {
        alert("Please enter task name and due date.");
        return;
      }

      tasks.push({ name, due, color });
      saveTasks();
      displayTasks();
    }

    function deleteTask(index) {
      tasks.splice(index, 1);
      saveTasks();
      displayTasks();
    }

    function displayTasks() {
      const container = document.getElementById("taskList");
      container.innerHTML = "";

      tasks.sort((a, b) => new Date(a.due) - new Date(b.due));

      tasks.forEach((task, index) => {
        const el = document.createElement("div");
        el.className = "task";
        el.style.backgroundColor = task.color;
        el.innerHTML = `
          <strong>${task.name}</strong><br>
          Due: ${task.due}<br>
          <button onclick="deleteTask(${index})">Delete</button>
        `;
        container.appendChild(el);
      });
    }

    function getLocation() {
      const output = document.getElementById("location");

      if (!navigator.geolocation) {
        output.innerText = "Geolocation not supported.";
        return;
      }

      navigator.geolocation.getCurrentPosition(success, error);

      function success(position) {
        const { latitude, longitude } = position.coords;
        output.innerHTML = `<p>Latitude: ${latitude}<br>Longitude: ${longitude}</p>`;

        fetch(`https://nominatim.openstreetmap.org/reverse?lat=${latitude}&lon=${longitude}&format=json`)
          .then(res => res.json())
          .then(data => {
            output.innerHTML += `<p><strong>Address:</strong> ${data.display_name}</p>`;
          })
          .catch(() => {
            output.innerHTML += "<p>Could not fetch address.</p>";
          });
      }

      function error(err) {
        output.innerText = "Error: " + err.message;
      }
    }

    // Initial load
    displayTasks();
  </script>
</body>
</html>
